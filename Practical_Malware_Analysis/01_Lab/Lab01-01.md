# NOTES


*1 - Upload the files VirusTotal. Do they match any existing antivirus definitions?*

### 1. VirusTotal Detection and Antivirus Classification

Two files are present in the sample set:

- Lab01-01.exe
- Lab01-01.dll

Both files were submitted to VirusTotal for reputation and signature-based detection.

#### 1.1 Lab01-01.exe

VirusTotal classifies this executable as a **malicious parasitic file infector**. 
According to the behavioral description provided by the platform, the sample exhibits the following functionality:

- Upon execution with a specific command-line argument ("WARNING_THIS_WILL_DESTROY_YOUR_MACHINE"), the program:
    - Drops a malicious DLL named Lab01-01.dll to C:\windows\system32\kerne132.dll
    - Recursively traverses the filesystem starting at C:\*
    - Locates all .exe files
    - Modifies their **Import Address Tables (IATs)** to replace references to the legitimate kernel32.dll with the malicious kerne132.dll
    - This forces infected executables to load the malicious DLL during execution

- Dominant detection labels and classifications:
    - **Populat threat label:** trojan.ulise/aenjaris
    - **Threat category:** Trojan
    - **Family labels:** ulise, aenjaris, kkbov

57/72 security vendors flagged this file as malicious

#### 1.2 Lab01-01.dll

The DLL component has 40/72 security vendors flagging it as malicious.

- Dominant detection labels an classifications:
    - **Popular threat label:** trojan.skeeyah/waski
    - **Threat category:** Trojan
    - **Family labels:** skeeyah, waski, genericrxfo

As we can see, both the dropper executable and the companion DLL are independently recognized as malicious artifacts.

-------------------------------------------------------------------------

*2. When were these files compiled?*

### 2. Compilation Timestamps

It is noted that **PE timestamps are not inherently trustworthy**, as they can be manually altered, zeroed by packers, or forged during compilation.

Using **CFF Explorer** or **PE-Bear**, for example, we can see the value *0x4D0E2FD3*.

Interpreted as a UNIX timestamp, which corresponds to:

- Approximate compilation date: 19 December 2010

**The DLL file exhibits a closely matching timestamp**, indicating that both components were possibly compiled within the same time window.

-------------------------------------------------------------------------

*3 - Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.* 


    Executable:
Detect It Easy shows a normal PE (PE32), with compiler/linker metadata (Microsoft Visual C++). the entropy graph shows mixed values (mostly well below the <7.5 range indicative of compressed/encrypted payloads), with a small region slightly below 6, but long stretches of low entropy and readable strings present. Setion layout (.text, .rdata, .data) appears normal and not dominated by a siingle high-entropy payload. Therefore there is **no strong evidence of packing** — no packer signature and no high-entropy plateau, with readable strings.
Conclusion: **not obviously packed**.

    .dll File:
The entropy graph for the DLL shows **consistently low entropy values**, with most of the file near 0 entropy and a single mild peak at approximately 3.6, which is well below the range typicaly associated with compressed or encrypted payloads. 
This pattern is consistent with normal compiled code and structured data rather than packed content.
Additionaly, the **strings** view reveals numerous huan-readable ASCII strings, and the section layout is standard (.text, .rdata, .data, .reloc).
Conclusion: **no evidence that Lab01-01.dll is packed or obfuscated**.

-------------------------------------------------------------------------

*4 - Do any imports hint at this program’s functionality? If so, which imports are they and what do they tell you?* 

    Executable:
Static analysis using **PE-Bear** reveals that the program imports functions primarily from **KERNEL32.dll** and **MSVCRT.dll**.

Several importer APIs strongly indicate **file system traversal and file modification behavior**. The presence of FindFirstFileA, FindNextFileA, and FindClose shows that the program is capable of enumerating files within diretories, which supports the observation that the malware recursively searches the filesystem. The use of CreateFileA and CopyFileA indicates that the program can create, open and duplicate files on disk.

The imports CreateFileMappingA, MapViewOfFile, and UnmapViewOfFile demonstrate that the program uses **memory-mapped files**, a technique commonly employed for directly modifying file contents in memory before writing them back to disk. This supports the observed behavior of modifying **Import Address Tables (IATs)** of executable files.

    .dll File:
Several imported APIs indicate explicit **process control and execution management** behavior. The presence of CreateProcessA demonstrated that the DLL is capable of spawning new processes, suggesting it actively uses external programs rather than serving as a passive library. The import of Sleep indicates that the DLL can delay its execution, which is commonly used for timing control or asic sandbox-evasion purposes.

The combined use of CreateMutexA and OpenMutexA strongly suggests the implementation of **single-instance execution control**, a common malware technique used to ensure that only one copy of the malicious component runs at a time on a system.

The DLL also lists **WS2_32.dll** as an imported module; however, the specific imported functions could not be resolved statically and appear only as ordinals. This suggests **potential networking capability**, although no definitive network functionality can be confirmed from the import table alone.

-------------------------------------------------------------------------

*5 - Are there any other files or host-based indicators that you could look for on infected systems?*

-------------------------------------------------------------------------

*6 - What network-based indicators could be used to identify this malware on infected machines?* 

-------------------------------------------------------------------------

*7 - What, would you guess, is the purpose of these files?*

-------------------------------------------------------------------------
