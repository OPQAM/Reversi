# NOTES


### *1 - Upload the files to VirusTotal. Do they match any existing antivirus definitions?*

    1. VirusTotal Detection and Antivirus Classification

Two files are present in the sample set:

- Lab01-01.exe
- Lab01-01.dll

Both files were submitted to VirusTotal for reputation and signature-based detection.

    1.1 Lab01-01.exe

VirusTotal classifies this executable as a **malicious parasitic file infector**. 
According to the behavioral description provided by the platform, the sample exhibits the following functionality:

- Upon execution with a specific command-line argument ("WARNING_THIS_WILL_DESTROY_YOUR_MACHINE"), the program:
    - Drops a malicious DLL named Lab01-01.dll to C:\windows\system32\kerne132.dll (not so for 32-bit redirection, as explained later)
    - Recursively traverses the filesystem starting at C:\*
    - Locates all .exe files
    - Modifies their **Import Address Tables (IATs)** to replace references to the legitimate kernel32.dll with the malicious kerne132.dll
    - This forces infected executables to load the malicious DLL during execution

- Dominant detection labels and classifications:
    - **Popular threat label:** trojan.ulise/aenjaris
    - **Threat category:** Trojan
    - **Family labels:** ulise, aenjaris, kkbov

57/72 security vendors flagged this file as malicious

    1.2 Lab01-01.dll

The DLL component has 40/72 security vendors flagging it as malicious.

- Dominant detection labels and classifications:
    - **Popular threat label:** trojan.skeeyah/waski
    - **Threat category:** Trojan
    - **Family labels:** skeeyah, waski, genericrxfo

As we can see, both the dropper executable and the companion DLL are independently recognized as malicious artifacts.

-------------------------------------------------------------------------

### *2. When were these files compiled?*

    2. Compilation Timestamps

It is noted that **PE timestamps are not inherently trustworthy**, as they can be manually altered, zeroed by packers, or forged during compilation.

Using **CFF Explorer** or **PE-Bear**, for example, we can see the value *0x4D0E2FD3*.

Interpreted as a UNIX timestamp, which corresponds to:

- Approximate compilation date: 19 December 2010

**The DLL file exhibits a closely matching timestamp**, indicating that both components were possibly compiled within the same time window.

-------------------------------------------------------------------------

### *3 - Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.* 


    Executable:
Detect It Easy shows a normal PE (PE32), with compiler/linker metadata (Microsoft Visual C++). the entropy graph shows mixed values (mostly well below the <7.5 range indicative of compressed/encrypted payloads), with a small region slightly below 6, but long stretches of low entropy and readable strings present. Section layout (.text, .rdata, .data) appears normal and not dominated by a single high-entropy payload. Therefore there is **no strong evidence of packing** — no packer signature and no high-entropy plateau, with readable strings.
Conclusion: **not obviously packed**.

    .dll File:
The entropy graph for the DLL shows **consistently low entropy values**, with most of the file near 0 entropy and a single mild peak at approximately 3.6, which is well below the range typically associated with compressed or encrypted payloads. 
This pattern is consistent with normal compiled code and structured data rather than packed content.
Additionally, the **strings** view reveals numerous human-readable ASCII strings, and the section layout is standard (.text, .rdata, .data, .reloc).
Conclusion: **no evidence that Lab01-01.dll is packed or obfuscated**.

-------------------------------------------------------------------------

### *4 - Do any imports hint at this program’s functionality? If so, which imports are they and what do they tell you?* 

    Executable:
Static analysis using **PE-Bear** reveals that the program imports functions primarily from **KERNEL32.dll** and **MSVCRT.dll**.

Several imported APIs strongly indicate **file system traversal and file modification behavior**. The presence of FindFirstFileA, FindNextFileA, and FindClose shows that the program is capable of enumerating files within directories, which supports the observation that the malware recursively searches the filesystem. The use of CreateFileA and CopyFileA indicates that the program can create, open and duplicate files on disk.

The imports CreateFileMappingA, MapViewOfFile, and UnmapViewOfFile demonstrate that the program uses **memory-mapped files**, a technique commonly employed for directly modifying file contents in memory before writing them back to disk. This supports the observed behavior of modifying **Import Address Tables (IATs)** of executable files.

    .dll File:
Several imported APIs indicate explicit **process control and execution management** behavior. The presence of CreateProcessA demonstrated that the DLL is capable of spawning new processes, suggesting it actively uses external programs rather than serving as a passive library. The import of Sleep indicates that the DLL can delay its execution, which is commonly used for timing control or basic sandbox-evasion purposes.

The combined use of CreateMutexA and OpenMutexA strongly suggests the implementation of **single-instance execution control**, a common malware technique used to ensure that only one copy of the malicious component runs at a time on a system.

The DLL also lists **WS2_32.dll** as an imported module; however, the specific imported functions could not be resolved statically and appear only as ordinals. This suggests **potential networking capability**, although no definitive network functionality can be confirmed from the import table alone.

-------------------------------------------------------------------------

### *5 - Are there any other files or host-based indicators that you could look for on infected systems?*

Static and behavioral evidence indicate that the malware drops a malicious dynamic-link library into the Windows system directory under a name designed to closely resemble a legitimate system component. Specifically, the file C:\Windows\System32\kerne132.dll is used in place of the legitimate kernel32.dll, with the substitution of the numeral "1" for the letter "l" serving as a visual deception technique.

The presence of this illegitimate file within the System32 directory constitutes a strong host-based indicator of compromise. This file can be reliably used for detection during incident response and forensic triage, as legitimate Windows installations do not contain a system library with this name.

-------------------------------------------------------------------------

### *6 - What network-based indicators could be used to identify this malware on infected machines?* 

Static analysis of the malicious DLL using string extraction (FLOSS) reveals the presence of a hard-coded IP address:
    127.26.152.13

This address falls within the IPv4 loopback range (127.0.0.0/8) and therefore does not correspond to a routable external host. Its inclusion nevertheless indicates that the malware contains explicit logic for IP-based network communication. The use of a loopback address strongly suggests that this value serves solely as a development or placeholder endpoint rather than a functional command-and-control server.

No additional hard-coded domains, URLs, or port numbers were recovered from either the DLL or the executable. Likewise, no network-related strings were extracted from the main executble.

-------------------------------------------------------------------------

### *7 - What, would you guess, is the purpose of these files?*

The executable systematically traverses the filesystem and copies files, while the accompanying DLL provides additional functionality including process creation, delayed execution, and network capability. The combined behavior strongly suggests that these files implement a self-propagating file infector that searches for executable files, modifies or replicates itself into them, and includes dormant or testing-stage network communication features. The presence of a disguised system-like DLL name further supports an attempt at stealth and persistence.

-------------------------------------------------------------------------

### *Dynamic Analysis (Bonus)*

Dynamic execution of the sample with the documented command‑line trigger resulted in the creation of kerne132.dll under C:\Windows\SysWOW64, consistent with expected 32‑bit redirection on 64‑bit Windows systems. This confirms the file‑drop behavior inferred from static analysis and validates the host‑based indicator

    File Metadata:
File size: 163,840 bytes
Creation time: 06 December 2025
Last modified: 19 December 2010

    Cryptographic hashes:
MD5: d8eb6cb737c168e968fc5623a442cee5
SHA‑256: 485895ba2f073fd9fefedb3fc51105a8a26a017a7a0d2d2d0c3d06848441499c

-------------------------------------------------------------------------

note aftermath:

The procedure entry point GetTickCount could not be located in the dynamic link library (filepath of program here)

